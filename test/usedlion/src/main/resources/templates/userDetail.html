<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}"
      th:with="hideHeader=true, hideFooter=true">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>유저 정보</title>

  <script>
    function openReportModal() {
      document.getElementById("reportModal").style.display = "block";
    }
    function closeReportModal() {
      document.getElementById("reportModal").style.display = "none";
    }
    window.onclick = function (event) {
      const modal = document.getElementById("reportModal");
      if (event.target == modal) {
        modal.style.display = "none";
      }
    };
  </script>
</head>


<body class="login-body">
<!-- Hide header and footer -->
<div layout:fragment="content">

  <div class="d-flex align-items-center justify-content-center" style="min-height: 100vh;">
    <div class="glass-card d-flex flex-column align-items-center p-4 w-100" style="max-width: 700px;">

      <h2 class="mb-3">👤 유저 정보</h2>
      <div class="bg-white p-3 rounded shadow-sm card">
        <p>닉네임: <strong th:text="${user.nickname}"></strong></p>
        <p>이메일: <strong th:text="${user.email}">작성자</strong></p>
        <p>
          신고:
          <a
                  href="javascript:void(0);"
                  onclick="openReportModal()"
                  class="text-danger fw-semibold"
          >
            [[${reportCount}]]회
          </a>
        </p>
      </div>

      <!-- 신고 모달 -->
      <div id="reportModal" class="modal">
        <div class="modal-content">
          <span class="close" onclick="closeReportModal()">&times;</span>
          <h5>🚨 신고 내역</h5>
          <ul class="mt-3 list-group" style="max-width: 600px; width: 100%;">
            <li class="list-group-item" th:each="report : ${reports}">
              사유: <span th:text="${report.content}">신고 사유</span>
            </li>
          </ul>
        </div>
      </div>

      <!-- 좋아요한 게시글 -->
      <div class="row w-100 mt-4">
        <div class="col-12">
          <h4 class="mb-3">👍 좋아요한 게시글 수: <span th:text="${likeCount}">0</span>개</h4>
          <ul class="list-group">
            <li class="list-group-item fw-bold">
              <div class="row text-center">
                <div class="col">제목</div>
                <div class="col">조회수</div>
                <div class="col">작성 날짜</div>
                <div class="col">썸네일</div>
              </div>
            </li>
            <li class="list-group-item">
              <div class="row text-center align-items-center" th:each="like : ${likes}">
                <div class="col" th:text="${like.post.title}">제목</div>
                <div class="col" th:text="${like.post.view}">0</div>
                <div class="col" th:text="${#temporals.format(like.post.created_at, 'yyyy-MM-dd')}">날짜</div>
                <div class="col">
                  <img th:if="${like.img != null}" th:src="'data:image/jpeg;base64,' + ${like.img}" style="max-height: 40px;" />
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <!-- 작성한 게시글 -->
      <div class="row w-100 mt-4">
        <div class="col-12">
          <h4 class="mb-3">📝 게시글 수: <span th:text="${postCount}">0</span>개</h4>
          <ul class="list-group">
            <li class="list-group-item fw-bold">
              <div class="row text-center">
                <div class="col">제목</div>
                <div class="col">조회수</div>
                <div class="col">작성 날짜</div>
                <div class="col">썸네일</div>
              </div>
            </li>
            <li class="list-group-item">
              <div class="row text-center align-items-center" th:each="post : ${posts}">
                <div class="col" th:text="${post.post.title}">제목</div>
                <div class="col" th:text="${post.post.view}">0</div>
                <div class="col" th:text="${#temporals.format(post.post.created_at, 'yyyy-MM-dd')}">날짜</div>
                <div class="col">
                  <img th:if="${post.img != null}" th:src="'data:image/jpeg;base64,' + ${post.img}" style="max-height: 40px;" />
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <!-- 작성한 댓글 -->
      <div class="row w-100 mt-4">
        <div class="col-12">
          <h4 class="mb-3">💬 댓글 수: <span th:text="${replyCount}">0</span>개</h4>
          <ul class="list-group">
            <li class="list-group-item fw-bold">
              <div class="row text-center">
                <div class="col">제목</div>
                <div class="col">내용</div>
                <div class="col">작성 날짜</div>
              </div>
            </li>
            <li class="list-group-item" th:each="reply : ${replies}">
              <div class="row text-center align-items-center">
                <div class="col" th:text="${reply.postTitle}">제목</div>
                <div class="col" th:text="${reply.content}">내용</div>
                <div class="col" th:text="${#temporals.format(reply.created_at, 'yyyy-MM-dd')}">날짜</div>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <div class="mt-4 text-end">
        <button class="btn btn-secondary" onclick="history.back()">
          ⬅ 이전으로
        </button>
      </div>
    </div>
  </div>
</body>
</html>
